<!DOCTYPE html>
<html>
<head>
  <title>Send Hi</title>
  <link rel="stylesheet" href="https://unpkg.com/oatcss/dist/oat.min.css">
  <script src="https://unpkg.com/oatjs/dist/oat.min.js"></script>
</head>
<body>

<main container="sm">
  <card>
    <h2>Send Message</h2>
    <div id="content"></div>
  </card>
</main>

<script>
const token = localStorage.getItem("token")
if (!token) window.location.href = "/login.html"

async function loadHi() {
  const res = await fetch("/api/auth/me", {
    headers: { Authorization: "Bearer " + token }
  })
  const user = await res.json()

  if (!user.wa_connected) {
    window.location.href = "/connect.html"
    return
  }

  document.getElementById("content").innerHTML = `
    <input id="number" placeholder="Enter number with country code">
    <button primary block onclick="send()">Send Hi</button>
  `
}

async function send() {
  const number = document.getElementById("number").value

  await fetch("/api/send", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: "Bearer " + token
    },
    body: JSON.stringify({ number })
  })

  alert("Message sent!")
}

loadHi()
</script>

</body>
</html> 